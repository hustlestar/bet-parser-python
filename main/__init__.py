# # encoding=cp1251
# import lxml.html as LH
# import requests
# import codecs
#
# from main.Bet import Bet
#
# user_id = 12345
# url = "https://www.parimatch.ru/bet.html?hd=7670497%2C7670498%2C7669969%2C7669072%2C7669372%2C7669785%2C7669358%2C7669836%2C7669856%2C7670093%2C7670467%2C7668815%2C7670317%2C7669751%2C7670444%2C7668809%2C7668810%2C7668811%2C7669616%2C7670355%2C7670433%2C7669073%2C7668802%2C7669045%2C7668789%2C7668798%2C7668799%2C7668800%2C7668801%2C7669787%2C7669328%2C7669590%2C7669591%2C7669592%2C7669095%2C7669771%2C7669772%2C7668814%2C7670341%2C7670344%2C7670343%2C7668996%2C7669376%2C7670393%2C7669281%2C7669374%2C7669812%2C7669371%2C7668797%2C7668717%2C7670369%2C7668813%2C7668834%2C7668830%2C7668997%2C7668831%2C7668782%2C7670821%2C7669362%2C7668812%2C7668839%2C7668866%2C7670526%2C7668864%2C7668974%2C7668751%2C7668987%2C7668922%2C7668923%2C7669012%2C7668926%2C7668927%2C7669019%2C7668925%2C7668710%2C7669925%2C7668726%2C7670240%2C7669233%2C7670379%2C7668803%2C7669009%2C7668804%2C7668779%2C7668828%2C7668781%2C7668780%2C7670385%2C7668711%2C7668721%2C7669312%2C7668796%2C7669241%2C7669873%2C7669446%2C7668848%2C7669163%2C7668763%2C7669289%2C7668861%2C7668865%2C7668955%2C7668849%2C7668985%2C7668991%2C7668712%2C7669189%2C7669639%2C7668743%2C7668825%2C7669235%2C7668806%2C7668708%2C7669081%2C7668816%2C7668889%2C7669060%2C7669001%2C7669049%2C7669028%2C7668917%2C7669394%2C7668746%2C7668975%2C7668718%2C7668770%2C7668709%2C7668732%2C7668884%2C7669035%2C7669681&hd=7670497%2C7670498%2C7669969%2C7669072%2C7669372%2C7669785%2C7669358%2C7669836%2C7669856%2C7670093%2C7670467%2C7668815%2C7670317%2C7669751%2C7670444%2C7668809%2C7668810%2C7668811%2C7669616%2C7670355%2C7670433%2C7669073%2C7668802%2C7669045%2C7668789%2C7668798%2C7668799%2C7668800%2C7668801%2C7669787%2C7669328%2C7669590%2C7669591%2C7669592%2C7669095%2C7669771%2C7669772%2C7668814%2C7670341%2C7670344%2C7670343%2C7668996%2C7669376%2C7670393%2C7669281%2C7669374%2C7669812%2C7669371%2C7668797%2C7668717%2C7670369%2C7668813%2C7668834%2C7668830%2C7668997%2C7668831%2C7668782%2C7670821%2C7669362%2C7668812%2C7668839%2C7668866%2C7670526%2C7668864%2C7668974%2C7668751%2C7668987%2C7668922%2C7668923%2C7669012%2C7668926%2C7668927%2C7669019%2C7668925%2C7668710%2C7669925%2C7668726%2C7670240%2C7669233%2C7670379%2C7668803%2C7669009%2C7668804%2C7668779%2C7668828%2C7668781%2C7668780%2C7670385%2C7668711%2C7668721%2C7669312%2C7668796%2C7669241%2C7669873%2C7669446%2C7668848%2C7669163%2C7668763%2C7669289%2C7668861%2C7668865%2C7668955%2C7668849%2C7668985%2C7668991%2C7668712%2C7669189%2C7669639%2C7668743%2C7668825%2C7669235%2C7668806%2C7668708%2C7669081%2C7668816%2C7668889%2C7669060%2C7669001%2C7669049%2C7669028%2C7668917%2C7669394%2C7668746%2C7668975%2C7668718%2C7668770%2C7668709%2C7668732%2C7668884%2C7669035%2C7669681&hd=7670497%2C7670498%2C7669969%2C7669072%2C7669372%2C7669785%2C7669358%2C7669836%2C7669856%2C7670093%2C7670467%2C7668815%2C7670317%2C7669751%2C7670444%2C7668809%2C7668810%2C7668811%2C7669616%2C7670355%2C7670433%2C7669073%2C7668802%2C7669045%2C7668789%2C7668798%2C7668799%2C7668800%2C7668801%2C7669787%2C7669328%2C7669590%2C7669591%2C7669592%2C7669095%2C7669771%2C7669772%2C7668814%2C7670341%2C7670344%2C7670343%2C7668996%2C7669376%2C7670393%2C7669281%2C7669374%2C7669812%2C7669371%2C7668797%2C7668717%2C7670369%2C7668813%2C7668834%2C7668830%2C7668997%2C7668831%2C7668782%2C7670821%2C7669362%2C7668812%2C7668839%2C7668866%2C7670526%2C7668864%2C7668974%2C7668751%2C7668987%2C7668922%2C7668923%2C7669012%2C7668926%2C7668927%2C7669019%2C7668925%2C7668710%2C7669925%2C7668726%2C7670240%2C7669233%2C7670379%2C7668803%2C7669009%2C7668804%2C7668779%2C7668828%2C7668781%2C7668780%2C7670385%2C7668711%2C7668721%2C7669312%2C7668796%2C7669241%2C7669873%2C7669446%2C7668848%2C7669163%2C7668763%2C7669289%2C7668861%2C7668865%2C7668955%2C7668849%2C7668985%2C7668991%2C7668712%2C7669189%2C7669639%2C7668743%2C7668825%2C7669235%2C7668806%2C7668708%2C7669081%2C7668816%2C7668889%2C7669060%2C7669001%2C7669049%2C7669028%2C7668917%2C7669394%2C7668746%2C7668975%2C7668718%2C7668770%2C7668709%2C7668732%2C7668884%2C7669035%2C7669681&hd=7670497%2C7670498%2C7669969%2C7669072%2C7669372%2C7669785%2C7669358%2C7669836%2C7669856%2C7670093%2C7670467%2C7668815%2C7670317%2C7669751%2C7670444%2C7668809%2C7668810%2C7668811%2C7669616%2C7670355%2C7670433%2C7669073%2C7668802%2C7669045%2C7668789%2C7668798%2C7668799%2C7668800%2C7668801%2C7669787%2C7669328%2C7669590%2C7669591%2C7669592%2C7669095%2C7669771%2C7669772%2C7668814%2C7670341%2C7670344%2C7670343%2C7668996%2C7669376%2C7670393%2C7669281%2C7669374%2C7669812%2C7669371%2C7668797%2C7668717%2C7670369%2C7668813%2C7668834%2C7668830%2C7668997%2C7668831%2C7668782%2C7670821%2C7669362%2C7668812%2C7668839%2C7668866%2C7670526%2C7668864%2C7668974%2C7668751%2C7668987%2C7668922%2C7668923%2C7669012%2C7668926%2C7668927%2C7669019%2C7668925%2C7668710%2C7669925%2C7668726%2C7670240%2C7669233%2C7670379%2C7668803%2C7669009%2C7668804%2C7668779%2C7668828%2C7668781%2C7668780%2C7670385%2C7668711%2C7668721%2C7669312%2C7668796%2C7669241%2C7669873%2C7669446%2C7668848%2C7669163%2C7668763%2C7669289%2C7668861%2C7668865%2C7668955%2C7668849%2C7668985%2C7668991%2C7668712%2C7669189%2C7669639%2C7668743%2C7668825%2C7669235%2C7668806%2C7668708%2C7669081%2C7668816%2C7668889%2C7669060%2C7669001%2C7669049%2C7669028%2C7668917%2C7669394%2C7668746%2C7668975%2C7668718%2C7668770%2C7668709%2C7668732%2C7668884%2C7669035%2C7669681&hd=7670497%2C7670498%2C7669969%2C7669072%2C7669372%2C7669785%2C7669358%2C7669836%2C7669856%2C7670093%2C7670467%2C7668815%2C7670317%2C7669751%2C7670444%2C7668809%2C7668810%2C7668811%2C7669616%2C7670355%2C7670433%2C7669073%2C7668802%2C7669045%2C7668789%2C7668798%2C7668799%2C7668800%2C7668801%2C7669787%2C7669328%2C7669590%2C7669591%2C7669592%2C7669095%2C7669771%2C7669772%2C7668814%2C7670341%2C7670344%2C7670343%2C7668996%2C7669376%2C7670393%2C7669281%2C7669374%2C7669812%2C7669371%2C7668797%2C7668717%2C7670369%2C7668813%2C7668834%2C7668830%2C7668997%2C7668831%2C7668782%2C7670821%2C7669362%2C7668812%2C7668839%2C7668866%2C7670526%2C7668864%2C7668974%2C7668751%2C7668987%2C7668922%2C7668923%2C7669012%2C7668926%2C7668927%2C7669019%2C7668925%2C7668710%2C7669925%2C7668726%2C7670240%2C7669233%2C7670379%2C7668803%2C7669009%2C7668804%2C7668779%2C7668828%2C7668781%2C7668780%2C7670385%2C7668711%2C7668721%2C7669312%2C7668796%2C7669241%2C7669873%2C7669446%2C7668848%2C7669163%2C7668763%2C7669289%2C7668861%2C7668865%2C7668955%2C7668849%2C7668985%2C7668991%2C7668712%2C7669189%2C7669639%2C7668743%2C7668825%2C7669235%2C7668806%2C7668708%2C7669081%2C7668816%2C7668889%2C7669060%2C7669001%2C7669049%2C7669028%2C7668917%2C7669394%2C7668746%2C7668975%2C7668718%2C7668770%2C7668709%2C7668732%2C7668884%2C7669035%2C7669681&hd=7669372%2C7669358%2C7670317%2C7670355%2C7668802%2C7669787"
#
# headers = {
#     'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:45.0) Gecko/20100101 Firefox/45.0'
# }
#
# r = requests.get(url, headers)
#
# with codecs.open('test.html', 'w', encoding='utf-8') as output_file:
#     output_file.write(r.text)
#
# with codecs.open('test.html', 'r', encoding='utf-8') as myfile:
#     data = myfile.read().replace('<br>', ' ')
#
# tree = LH.fromstring(data)
# tableBets = tree.xpath('//table[@class="dt twp"]')[0]  # table теги с атрибутом class равным "dt twp"
#
# # betRows = tableBets.xpath('.//tr[@class="bk"]')
# betRows = tableBets.xpath('.//tr')  # [@class="bk"]
# headerRow = tableBets.xpath('.//th')
#
# validBets = []
#
#
# def getName(row):
#     val = row.xpath('.//a[@class="om"]')
#     if len(val) > 0:
#         return val[0].text
#     else:
#         return None
#
#
# def getAdditionalBets(row):
#     dict = {}
#     val = row.xpath('.//table')
#     last = ""
#     if len(val) > 0:
#         if len(val[0].xpath('.//tr/th')) > 0:
#             if val[0].xpath('.//tr/th')[0].text == u'Дополнительные форы:' and len(
#                     val[0].xpath('.//tr/td/table/tr')) > 1:
#                 for v in val[0].xpath('.//tr/td/table/tr/td'):
#                     g = v.text_content().replace(";", "").split(':')
#                     if len(g) == 1:
#                         m = g[0].split(' ')
#                         for c in xrange(0, len(m) - 1, 2):
#                             dict[last + " " + m[c]] = m[c + 1]
#                     else:
#                         last = g[0]
#     return dict
#
#
# def getBets(row):
#     dict = {}
#     vals = row.xpath('.//td')
#     dict[headerRow[3].text + " " + vals[3].xpath('.//b')[0].text] = vals[4].xpath('.//a')[0].text
#     dict[headerRow[3].text + " " + vals[3].xpath('.//b')[1].text] = vals[4].xpath('.//a')[1].text
#     return dict
#
#
# for record in betRows:
#     if getName(record):
#         newBet = Bet()
#         newBet.title = getName(record)
#         newBet.mapOfAllBets = getBets(record)
#         validBets.append(newBet)
#     elif len(validBets) > 0:
#         validBets[-1].mapOfAllBets.update(getAdditionalBets(record))
#         continue
#
#
# def foraMinusOneLowCaf(bets):
#     for b in bets:
#         for key, val in b.mapOfAllBets.items():
#             if u"–1.0" in key:
#                 if float(val) < 1.4:
#                     print b.title + " " + key + " " + val
#
#
# foraMinusOneLowCaf(validBets)
#
# with codecs.open('result.csv', 'w', 'utf-8') as output:
#     for x in validBets:
#         output.write((x.__str__() + u"\n"))
# output.close()
